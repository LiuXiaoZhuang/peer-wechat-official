"use strict";var t=require("axios"),e=require("crypto"),s=require("xml2js"),i=require("form-data");function a(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}function c(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(s){if("default"!==s){var i=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:function(){return t[s]}})}})),e.default=t,Object.freeze(e)}var n=a(t),r=c(e),p=c(s),h=a(i);class u{constructor(){this.logger=console}setLogger(t){this.logger=t}setAccessToken(t){this.accessToken=t}setJsapiTicket(t){this.jsapiTicket=t}async request(t,e={}){try{let s=await n.default(t,e);return s.status<200||s.status>=204?(null!==this.logger&&this.logger.error("[WechatOfficial]网络错误："+JSON.stringify({url:t,options:e})),{status:"network",result:null,error:null}):"errcode"in s.data&&0!==s.data.errcode?(null!==this.logger&&this.logger.warn("[WechatOfficial]结果失败："+JSON.stringify({url:t,options:e})),{status:"fail",result:null,error:s.data}):(this.logger.info("[WechatOfficial]请求成功："+JSON.stringify({url:t,options:e,res:s.data})),{status:"success",result:s.data,error:null})}catch(s){null!==this.logger&&this.logger.error("请求错误："+JSON.stringify({url:t,options:e}))}return{status:"system",result:null,error:null}}async downloadFile(t){let e=await n.default.get(t,{responseType:"stream"});return e.status<200||e.status>204?null:e.data}randStr(t=8){if(t<=0)return"";let e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s="";for(let i=0;i<t;i++)s+=e[Math.floor(Math.random()*(e.length-.1))];return s}}class o{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async getAccessToken(){return this.util.request("https://api.weixin.qq.com/cgi-bin/token",{method:"GET",params:{grant_type:"client_credential",appid:this.appID,secret:this.appSecret}})}async getApiDomainIP(){return this.util.request("https://api.weixin.qq.com/cgi-bin/get_api_domain_ip",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}}class l{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async clearQuota(){return this.util.request("https://api.weixin.qq.com/cgi-bin/clear_quota",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{appid:this.appID}})}async getQuota(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/openapi/quota/get",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{cgi_path:t}})}async getRid(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/openapi/rid/get",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{rid:t}})}}class d{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async create(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/menu/create",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async getCurrentSelfmenuInfo(){return this.util.request("https://api.weixin.qq.com/cgi-bin/get_current_selfmenu_info",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async delete(){return this.util.request("https://api.weixin.qq.com/cgi-bin/menu/delete",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async addConditional(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/menu/addconditional",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async delConditional(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/menu/delconditional",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{menuid:t}})}async trymatchConditional(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/menu/trymatch",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{user_id:t}})}async getMenu(){return this.util.request("https://api.weixin.qq.com/cgi-bin/menu/get",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}}class m{constructor(t,e,s){if(!t||!e||!s)throw new Error("please check arguments");this.token=t,this.id=s;let i=Buffer.from(e+"=","base64");if(32!==i.length)throw new Error("encodingAESKey invalid");this.key=i,this.iv=i.slice(0,16)}getSignature(t,e,s){let i=r.createHash("sha1"),a=[this.token,t,e,s].sort();return i.update(a.join("")),i.digest("hex")}decrypt(t){let e=r.createDecipheriv("aes-256-cbc",this.key,this.iv);e.setAutoPadding(!1);let s=Buffer.concat([e.update(t,"base64"),e.final()]);s=function(t){let e=t[t.length-1];return(e<1||e>32)&&(e=0),t.slice(0,t.length-e)}(s);let i=s.slice(16),a=i.slice(0,4).readUInt32BE(0);return i.slice(4,a+4).toString()}encrypt(t){let e=r.pseudoRandomBytes(16),s=Buffer.from(t),i=Buffer.from("4");i.writeUInt32BE(s.length,0);let a=Buffer.from(this.id),c=function(t){let e=32-t.length%32,s=Buffer.from(e.toString());return s.fill(e),Buffer.concat([t,s])}(Buffer.concat([e,i,s,a])),n=r.createCipheriv("aes-256-cbc",this.key,this.iv);return n.setAutoPadding(!1),Buffer.concat([n.update(c),n.final()]).toString("base64")}}function g(t){var e={};if("object"==typeof t)for(var s in t)if(t[s]instanceof Array&&0!==t[s].length)if(1===t[s].length){var i=t[s][0];e[s]="object"==typeof i?g(i):(i||"").trim()}else e[s]=[],t[s].forEach((function(t){e[s].push(g(t))}));return e}async function q(t){return new Promise(((e,s)=>{p.parseString(t,{trim:!0},(function(t,i){if(t)s(t);else{let t=g(i.xml);e(t)}}))}))}class w{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}checkAccess(t,e,s,i){let a=r.createHash("sha1"),c=[t,e,s].sort();return a.update(c.join("")),a.digest("hex")!==i}async decryptMessage(t,e="",s="",i=""){if("aes"!==e)return t;if(""===s)return this.util.logger.error("token 为空"),null;if(""===i)return this.util.logger.error("encodingAESKey 为空"),null;try{let e=new m(s,i,this.appID).decrypt(t.Encrypt);return await q(e)}catch(t){return this.util.logger.error(`解密失败：${JSON.stringify(t)}`),null}}}class T{buildMessage(t){return`<xml>\n                    <ToUserName><![CDATA[${t.ToUserName}]]></ToUserName>\n                    <FromUserName><![CDATA[${t.FromUserName}]]></FromUserName>\n                    <CreateTime>${t.CreateTime}</CreateTime>\n                    <MsgType><![CDATA[${t.MsgType}]]></MsgType>\n                    ${this.buildMessageContent(t)}\n                </xml>`}buildMessageContent(t){switch(t.MsgType){case"text":return`<Content><![CDATA[${t.Content}]]></Content>`;case"image":return`<Image>\n                            <MediaId><![CDATA[${t.Image.MediaId}]]></MediaId>\n                        </Image>`;case"voice":return`<Voice>\n                            <MediaId><![CDATA[${t.Voice.MediaId}]]></MediaId>\n                        </Voice>`;case"video":return`<Video>\n                            <MediaId><![CDATA[${t.Video.MediaId}]]></MediaId>\n                            ${"Title"in t.Video?`<Title><![CDATA[${t.Video.Title}]]></Title>`:""}\n                            ${"Description"in t.Video?`<Description><![CDATA[${t.Video.Description}]]></Description>`:""}\n                        </Video>`;case"music":return`<Music>\n                            <ThumbMediaId><![CDATA[${t.Music.ThumbMediaId}]]></ThumbMediaId>\n                            ${"Title"in t.Music?`<Title><![CDATA[${t.Music.Title}]]></Title>`:""}\n                            ${"Description"in t.Music?`<Description><![CDATA[${t.Music.Description}]]></Description>`:""}\n                            ${"MusicUrl"in t.Music?`<MusicUrl><![CDATA[${t.Music.MusicUrl}]]></MusicUrl>`:""}\n                            ${"HQMusicUrl"in t.Music?`<HQMusicUrl><![CDATA[${t.Music.HQMusicUrl}]]></HQMusicUrl>`:""}\n                        </Music>`;case"news":return`<ArticleCount>${t.Articles.length}</ArticleCount>\n                        <Articles>\n                            ${t.Articles.map((t=>`<item>\n                                                <Title><![CDATA[${t.Title}]]></Title>\n                                                <Description><![CDATA[${t.Description}]]></Description>\n                                                <PicUrl><![CDATA[${t.PicUrl}]]></PicUrl>\n                                                <Url><![CDATA[${t.Url}]]></Url>\n                                            </item>`)).join("")}\n                        </Articles>`;case"transfer_customer_service":if("TransInfo"in t)return`<TransInfo> \n                                <KfAccount><![CDATA[${t.TransInfo.KfAccount}]]></KfAccount> \n                            </TransInfo>`}return""}}class k{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async setIndustry(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/template/api_set_industry",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{industry_id1:t,industry_id2:e}})}async getIndustry(){return this.util.request("https://api.weixin.qq.com/cgi-bin/template/get_industry",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async add(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/template/api_add_template",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{template_id_short:t}})}async getTemplates(){return this.util.request("https://api.weixin.qq.com/cgi-bin/template/get_all_private_template",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async del(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/template/del_private_template",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{template_id:t}})}async send(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/template/send",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}}class _{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async add(t){return this.util.request("https://api.weixin.qq.com/wxaapi/newtmpl/addtemplate",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async delete(t){return this.util.request("https://api.weixin.qq.com/wxaapi/newtmpl/deltemplate",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{priTmplId:t}})}async getCategory(){return this.util.request("https://api.weixin.qq.com/wxaapi/newtmpl/getcategory",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async getKeywords(t){return this.util.request("https://api.weixin.qq.com/wxaapi/newtmpl/getpubtemplatekeywords",{method:"GET",params:{access_token:await this.util.accessToken(this.appID),tid:t}})}async getPubTemplates(t,e,s){return this.util.request("https://api.weixin.qq.com/wxaapi/newtmpl/getpubtemplatetitles",{method:"GET",params:{access_token:await this.util.accessToken(this.appID),ids:t,start:e,limit:s}})}async getTemplates(){return this.util.request("https://api.weixin.qq.com/wxaapi/newtmpl/gettemplate",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async send(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/subscribe/bizsend",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}}class D{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async addAccount(t){return this.util.request("https://api.weixin.qq.com/customservice/kfaccount/add",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async updateAccount(t){return this.util.request("https://api.weixin.qq.com/customservice/kfaccount/update",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async delAccount(t){return this.util.request("https://api.weixin.qq.com/customservice/kfaccount/del",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{kf_account:t}})}async uploadHeadImg(t,e){let s=new h.default;s.append("",e);let i=await new Promise(((t,e)=>s.getLength(((s,i)=>s?e(s):t(i)))));return this.util.request("https://api.weixin.qq.com/customservice/kfaccount/uploadheadimg",{method:"POST",params:{access_token:await this.util.accessToken(this.appID),kf_account:t},data:s,headers:Object.assign(Object.assign({},s.getHeaders()),{"Content-Length":i})})}async accountList(){return this.util.request("https://api.weixin.qq.com/cgi-bin/customservice/getkflist",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async send(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/custom/send",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async typing(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/custom/typing",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{touser:t,command:e}})}}class b{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}getAuthUrl(t,e,s){return`https://open.weixin.qq.com/connect/oauth2/authorize?appid=${this.appID}&redirect_uri=${t}&response_type=code&scope=${e}&state=${s}#wechat_redirect`}async accessToken(t){return this.util.request("https://api.weixin.qq.com/sns/oauth2/access_token",{method:"GET",params:{appid:this.appID,secret:this.appSecret,code:t,grant_type:"authorization_code"}})}async refreshAccessToken(t){return this.util.request("https://api.weixin.qq.com/sns/oauth2/refresh_token",{method:"GET",params:{appid:this.appID,grant_type:"refresh_token",refresh_token:t}})}async userInfo(t,e,s="zh_CN"){return this.util.request("https://api.weixin.qq.com/sns/userinfo",{method:"GET",params:{access_token:t,openid:e,lang:s}})}async checkAccessToken(t,e){return this.util.request("https://api.weixin.qq.com/sns/auth",{method:"GET",params:{access_token:t,openid:e}})}async getTicket(){return this.util.request("https://api.weixin.qq.com/cgi-bin/ticket/getticket",{method:"GET",params:{access_token:await this.util.accessToken(this.appID),type:"jsapi"}})}async getWxConfig(t,e=!1,s=[],i){let a=this.util.randStr(16),c=await this.util.jsapiTicket(this.appID),n=parseInt(Math.round((new Date).valueOf()/1e3).toFixed(0)),p=[`jsapi_ticket=${c}`,`noncestr=${a}`,`timestamp=${n}`,`url=${t}`],h=r.createHash("sha1");return h.update(p.join("&")),{debug:e,appId:this.appID,timestamp:n,nonceStr:a,signature:h.digest("hex"),jsApiList:s,openTagList:i}}}class y{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async uploadTmpMedia(t,e){let s=new h.default;s.append("media",e);let i=await new Promise(((t,e)=>s.getLength(((s,i)=>s?e(s):t(i)))));return this.util.request("https://api.weixin.qq.com/cgi-bin/media/upload",{method:"POST",params:{access_token:await this.util.accessToken(this.appID),type:t},data:s,headers:Object.assign(Object.assign({},s.getHeaders()),{"Content-Length":i})})}async downloadTmpMedia(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/media/get",{method:"GET",params:{access_token:await this.util.accessToken(this.appID),media_id:t}})}async uploadImg(t){let e=new h.default;e.append("media",t);let s=await new Promise(((t,s)=>e.getLength(((e,i)=>e?s(e):t(i)))));return this.util.request("https://api.weixin.qq.com/cgi-bin/media/uploadimg",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:e,headers:Object.assign(Object.assign({},e.getHeaders()),{"Content-Length":s})})}async uploadMedia(t){let e=new h.default;e.append("media",t.fileContent),"video"===t.type&&e.append("description",JSON.stringify({title:t.title,introduction:t.introduction}));let s=await new Promise(((t,s)=>e.getLength(((e,i)=>e?s(e):t(i)))));return this.util.request("https://api.weixin.qq.com/cgi-bin/media/upload",{method:"POST",params:{access_token:await this.util.accessToken(this.appID),type:t.type},data:e,headers:Object.assign(Object.assign({},e.getHeaders()),{"Content-Length":s})})}async addNewsMedia(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/material/add_news",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{articles:t}})}async updateNewsMedia(t,e,s){return this.util.request("https://api.weixin.qq.com/cgi-bin/material/update_news",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{media_id:t,index:e,articles:s}})}async getMedia(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/material/get_material",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{media_id:t}})}async delMedia(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/material/del_material",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{media_id:t}})}async mediaCount(){return this.util.request("https://api.weixin.qq.com/cgi-bin/material/get_materialcount",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async mediaList(t,e=0,s=20){return this.util.request("https://api.weixin.qq.com/cgi-bin/material/batchget_material",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{type:t,offset:e,count:s}})}async uploadVideo(t,e,s){return this.util.request("https://api.weixin.qq.com/cgi-bin/media/uploadvideo",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{media_id:t,title:e,description:s}})}}class I{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async addDraft(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/draft/add",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{articles:t}})}async getDraft(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/draft/get",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{media_id:t}})}async deleteDraft(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/draft/delete",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{media_id:t}})}async updateDraft(t,e,s){return this.util.request("https://api.weixin.qq.com/cgi-bin/draft/update",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{media_id:t,index:e,articles:s}})}async countDraft(){return this.util.request("https://api.weixin.qq.com/cgi-bin/draft/count",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async draftList(t=0,e=20,s=!1){return this.util.request("https://api.weixin.qq.com/cgi-bin/draft/batchget",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{offset:t,count:e,no_content:s?1:0}})}}class S{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async submit(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/freepublish/submit",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{media_id:t}})}async getStatus(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/freepublish/get",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{publish_id:t}})}async delete(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/freepublish/delete",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{article_id:t,index:e}})}async getArticle(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/freepublish/getarticle",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{article_id:t}})}async articleList(t=0,e=20,s=!1){return this.util.request("https://api.weixin.qq.com/cgi-bin/freepublish/batchget",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{offset:t,count:e,no_content:s?1:0}})}}class f{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async sendWithTag(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/mass/sendall",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async sendWithOpenID(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/mass/send",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async delete(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/mass/delete",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{msg_id:t,article_idx:e}})}async preview(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/mass/preview",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async getStatus(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/mass/get",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{msg_id:t}})}async setSpeed(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/message/mass/speed/set",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{speed:t}})}}class x{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async open(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/comment/open",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{msg_data_id:t,index:e}})}async close(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/comment/close",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{msg_data_id:t,index:e}})}async list(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/comment/list",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async markElect(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/comment/markelect",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async unMarkElect(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/comment/unmarkelect",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async delete(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/comment/delete",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async reply(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/comment/reply/add",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async deleteReply(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/comment/reply/delete",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}}class O{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async updateRemark(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/user/info/updateremark",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{openid:t,remark:e}})}async userInfo(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/user/info",{method:"GET",params:{access_token:await this.util.accessToken(this.appID),openid:t,lang:e}})}async batchUserInfo(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/user/info/batchget",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}async list(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/user/get",{method:"GET",params:{access_token:await this.util.accessToken(this.appID),next_openid:t}})}}class P{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async create(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/create",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{tag:{name:t}}})}async list(){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/get",{method:"GET",params:{access_token:await this.util.accessToken(this.appID)}})}async update(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/update",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{tag:{id:t,name:e}}})}async delete(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/delete",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{tag:{id:t}}})}async userList(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/user/tag/get",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{tagid:t,next_openid:e}})}async batchTagging(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/members/batchtagging",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{tagid:t,openid_list:e}})}async cancelTagging(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/members/batchuntagging",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{tagid:t,openid_list:e}})}async userTags(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/getidlist",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{openid:t}})}}class A{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async list(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/members/getblacklist",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_openid:t}})}async black(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/members/batchblacklist",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{openid_list:t}})}async cancelBlack(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/tags/members/batchunblacklist",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{openid_list:t}})}}class M{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async create(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/qrcode/create",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:t})}getUrl(t){return`https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=${t}`}}class C{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async create(t,e){return this.util.request("https://api.weixin.qq.com/cgi-bin/shorten/gen",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{long_data:t,expire_seconds:e}})}async analysis(t){return this.util.request("https://api.weixin.qq.com/cgi-bin/shorten/fetch",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{short_key:t}})}}class U{constructor(t,e,s){this.appID=t,this.appSecret=e,this.util=s}async getUserSummary(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getusersummary",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUserCumulate(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getusercumulate",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getArticleSummary(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getarticlesummary",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getArticleTotal(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getarticletotal",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUserRead(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getuserread",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUserReadHour(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getuserreadhour",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUserShare(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getusershare",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUserShareHour(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getusersharehour",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUpstreamMsg(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getupstreammsg",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUpstreamMsgHour(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getupstreammsghour",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUpstreamMsgWeek(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getupstreammsgweek",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUpstreamMsgMonth(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getupstreammsgmonth",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUpstreamMsgDist(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getupstreammsgdist",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUpstreamMsgDistWeek(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getupstreammsgdistweek",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async getUpstreamMsgDistMonth(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getupstreammsgdistmonth",{method:"POST",params:{access_token:await this.util.accessToken(this.appID)},data:{begin_date:t,end_date:e}})}async publisherAdposGeneral(t,e){return this.util.request("https://api.weixin.qq.com/publisher/stat",{method:"POST",params:{access_token:await this.util.accessToken(this.appID),action:"publisher_adpos_general"},data:Object.assign(Object.assign({},t),{ad_slot:e})})}async publisherCpsGeneral(t){return this.util.request("https://api.weixin.qq.com/publisher/stat",{method:"POST",params:{access_token:await this.util.accessToken(this.appID),action:"publisher_cps_general"},data:t})}async publisherSettlement(t){return this.util.request("https://api.weixin.qq.com/publisher/stat",{method:"POST",params:{access_token:await this.util.accessToken(this.appID),action:"publisher_settlement"},data:t})}async getInterfaceSummary(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getinterfacesummary",{method:"POST",params:{access_token:await this.util.accessToken(this.appID),action:"publisher_settlement"},data:{begin_date:t,end_date:e}})}async getInterfaceSummaryHour(t,e){return this.util.request("https://api.weixin.qq.com/datacube/getinterfacesummaryhour",{method:"POST",params:{access_token:await this.util.accessToken(this.appID),action:"publisher_settlement"},data:{begin_date:t,end_date:e}})}}module.exports=class{constructor(t,e,s={}){this.appID=t,this.appSecret=e,this.util=new u,s.getAccessToken&&this.util.setAccessToken(s.getAccessToken),s.getJsapiTicket&&this.util.setJsapiTicket(s.getJsapiTicket),this.base=new o(this.appID,this.appSecret,this.util),this.openApi=new l(this.appID,this.appSecret,this.util),this.menu=new d(this.appID,this.appSecret,this.util),this.receive=new w(this.appID,this.appSecret,this.util),this.reply=new T,this.template=new k(this.appID,this.appSecret,this.util),this.subscribe=new _(this.appID,this.appSecret,this.util),this.service=new D(this.appID,this.appSecret,this.util),this.web=new b(this.appID,this.appSecret,this.util),this.media=new y(this.appID,this.appSecret,this.util),this.draft=new I(this.appID,this.appSecret,this.util),this.publish=new S(this.appID,this.appSecret,this.util),this.message=new f(this.appID,this.appSecret,this.util),this.comment=new x(this.appID,this.appSecret,this.util),this.userTag=new P(this.appID,this.appSecret,this.util),this.user=new O(this.appID,this.appSecret,this.util),this.userBlack=new A(this.appID,this.appSecret,this.util),this.qrcode=new M(this.appID,this.appSecret,this.util),this.shortKey=new C(this.appID,this.appSecret,this.util),this.count=new U(this.appID,this.appSecret,this.util)}};
//# sourceMappingURL=index.js.map
